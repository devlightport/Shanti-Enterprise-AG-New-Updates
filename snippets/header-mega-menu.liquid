{% comment %}
	Renders an header mega menu.

	Accepts:
	- links: {Array} Menu links
	- block: {Object} Menu Block Object
	- collection: {Object} Collection Object
	- collections: {Array} Collections Array
	- product: {Object} Product Object
	Usage:
	if menu type is 'mega_menu_collection' :
		{% render 'header-submenu' links: link.links, %}
	if menu type is 'mega_menut' :
		{% render 'header-submenu' links: link.links, %}
{% endcomment %}
{% liquid
	case block.type
		when 'mega_menu'
			assign menu_link = link.url 
		else
			assign menu_link = '##'
			assign menu_link_class = 'cursor-default'
	endcase
%}
<a
	href="{{ menu_link }}"
	class="unstyled-link header__menu-item {{ menu_link_class }}{% if link.current %} current-link{% endif %}"
	{% if link.current %}
		aria-current="page"
	{% endif %}
>
	{{- link.title | escape }}
</a>
<div class="header-mega-menu color-background-1">
	<div class="container">
		{% if block.type == 'mega_menu' %}
			<div class="header-mega-menu__wrapper">
				<div class="mega-menu_list">
					{%- if block.settings.additional_menu != blank -%}
						<ul class="mega-menu_additional_menu list-unstyled">
							{%- for link in block.settings.additional_menu.links -%}
								<li>
									<a
										href="{{ link.url }}"
										class="header-mega-menu__link h6"
									>
										<span>{{ link.title }}</span>
									</a>
								</li>
							{%- endfor -%}
						</ul>
					{%- endif -%}
					{%- if links != blank -%}
						<ul class="header-mega-menu__have-submenu__list list-unstyled">
							{% if block.settings.menu_name_1 %}
								<li class="menu_name">
									<span class="subtitle">{{ block.settings.menu_name_1 }}</span>
								</li>
							{% endif %}

							{%- for childlink in links -%}
								<li>
									{% if childlink.links == blank %}
										<a
											href="{{ childlink.url }}"
											class="header-mega-menu__link"
											{% if childlink.current %}
												aria-current="page"
											{% endif %}
											{% if childlink.type == 'http_link'
												and settings.open_new_tab
											%}
												target="_blank"
											{% endif %}
										>
											<span>
												{{ childlink.title | escape }}
											</span>
										</a>
									{% else %}
											<a
												href="{{ childlink.url }}"
												class="header-mega-menu__link"
												{% if childlink.current %}
													aria-current="page"
												{% endif %}
												{% if childlink.type == 'http_link'
													and settings.open_new_tab
												%}
													target="_blank"
												{% endif %}
											>
												<span class="header-menu-trigger">
													{{ childlink.title | escape }}
												</span>
											</a>
										<ul class="header-mega-menu__submenu list-unstyled {% if block.settings.menu_name_2 %} has-meuu_name{% endif %}">
											{% if block.settings.menu_name_2 %}
												<li class="menu_name">
													<span class="subtitle">
														{{- block.settings.menu_name_2 -}}
													</span>
												</li>
											{% endif %}

											{%- for grandchildlink in childlink.links -%}
												<li class=" {% if grandchildlink.current %}current-link{% endif %}">
													<a
														href="{{ grandchildlink.url }}"
														{% if grandchildlink.type == 'http_link'
															and settings.open_new_tab
														%}
															target="_blank"
														{% endif %}
														class="unstyled-link hover-opacity"
													>
														{{- grandchildlink.title | escape -}}
													</a>
												</li>
											{%- endfor -%}
										</ul>
									{% endif %}
								</li>
							{%- endfor -%}
						</ul>
					{%- endif -%}
				</div>
				{% if block.settings.show_promo or block.settings.show_promo_2 %}
					<div class="header-mega-menu__collection-list">
						{% if block.settings.show_promo %}
							<div class="mega-menu__collection-block">
								<div class="mega-menu__collection color-{{ block.settings.color_scheme }}">
									{% if block.settings.image != blank %}
										{{
											block.settings.image
											| image_url: width: block.settings.image.width
											| image_tag:
												loading: 'lazy',
												sizes: '100vw',
												widths: '360, 550, 710, 1100, 1420, 1700, 1920',
												width: block.settings.image.width,
												class: 'mega-menu__item-image'
										}}
									{% else %}
										{{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
									{%- endif -%}
									<span
										class="image_overlay"
										style="opacity: {{ block.settings.effect_opacity }}"
									></span>

									<div class="promo_text">
										{%- if block.settings.subheading != blank -%}
											<div class="subtitle">
												{{ block.settings.subheading }}
											</div>
										{%- endif -%}
										{%- if block.settings.heading != blank -%}
											<h5>
												{{ block.settings.heading }}
											</h5>
										{%- endif -%}
									</div>

									<a
										{% if block.settings.button_link.url != blank %}
											href="{{ block.settings.button_link }}"
										{% endif %}
										class="mega-menu__collection-link-overlay"
										{% if block.settings.button_link.url == blank %}
											aria-disabled="true"
										{% endif %}
										aria-label="Promo banner"
									></a>
								</div>
							</div>
						{% endif %}
						{% if block.settings.show_promo_2 %}
							<div class="mega-menu__collection-block">
								<div class="mega-menu__collection color-{{ block.settings.color_scheme_2 }}">
									{% if block.settings.image_2 != blank %}
										{{
											block.settings.image_2
											| image_url: width: block.settings.image_2.width
											| image_tag:
												loading: 'lazy',
												sizes: '100vw',
												widths: '360, 550, 710, 1100, 1420, 1700, 1920',
												width: block.settings.image_2.width,
												class: 'mega-menu__item-image'
										}}
									{% else %}
										{{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
									{%- endif -%}
									<span
										class="image_overlay"
										style="opacity: {{ block.settings.effect_opacity_2 }}"
									></span>

									<div class="promo_text">
										{%- if block.settings.subheading_2 != blank -%}
											<p class="subtitle">
												{{ block.settings.subheading_2 }}
											</p>
										{%- endif -%}
										{%- if block.settings.heading_2 != blank -%}
											<h5>
												{{ block.settings.heading_2 }}
											</h5>
										{%- endif -%}
									</div>

									<a
										{% if block.settings.button_link_2.url != blank %}
											href="{{ block.settings.button_link_2 }}"
										{% endif %}
										class="mega-menu__collection-link-overlay"
										{% if block.settings.button_link_2.url == blank %}
											aria-disabled="true"
										{% endif %}
										aria-label="Promo banner"
									></a>
								</div>
							</div>
						{% endif %}
					</div>
				{% endif %}
			</div>
		{% endif %}
	</div>
	<div class="mega-menu-announcement-bar">
		<div class="container">
			{% if block.settings.bar_text != blank %}
				<div class="mega-menu-announcement-bar__text small-font">
					{{ block.settings.bar_text }}
					{% render 'button',
						btn_label: block.settings.bar_button_label,
						btn_link: block.settings.bar_button_link,
						btn_style: "tertiary",
						enable_arrow: block.settings.bar_button_arrow
					%}
				</div>
			{% endif %}
		</div>
	</div>
</div>
